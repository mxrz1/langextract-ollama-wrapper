# STIX Entity Extraction Configuration

# Model settings
model:
  model_id: "gemma3:27b"
  model_url: "http://localhost:11434"
  max_retries: 5
  num_ctx: 4096  # Context window size in tokens (default: 2048)
  max_char_buffer: 1200  # Max characters per chunk for long documents (default: 1000)

# Dataset settings
dataset:
  dataset_dir: "datasets/stixnet_single_sentence"
  splits: ["test"]  # Process only test split
  train_file: null  # null = auto-detect from dataset_dir

# Extraction settings
extraction:
  num_examples: 1  # Number of examples PER entity type (1=one example per type, 2=two examples per type, etc.)

  # Custom extraction prompt (entity descriptions will be added automatically if present)
  prompt: |
    Extract cybersecurity threat intelligence entities from the text.

  # Entity types with descriptions (will be added to prompt)
  entity_types:
    intrusion-set:
      # https://oasis-open.github.io/cti-documentation/stix/intro.html
      description: "A grouped set of adversarial behaviors and resources with common properties that is believed to be orchestrated by a single organization."

    attack-pattern:
      # source: https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_axjijf603msy
      description: "Attack Patterns are a type of TTP that describe ways that adversaries attempt to compromise targets. Attack Patterns are used to help categorize attacks, generalize specific attacks to the patterns that they follow, and provide detailed information about how attacks are performed."

    malware:
      # source: https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_s5l7katgbp09
      description: "Malware is a type of TTP that represents malicious code. It generally refers to a program that is inserted into a system, usually covertly. The intent is to compromise the confidentiality, integrity, or availability of the victim's data, applications, or operating system (OS) or otherwise annoy or disrupt the victim."

    tool:
      # source: https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_z4voa9ndw8v
      description: "Tools are legitimate software that can be used by threat actors to perform attacks. Knowing how and when threat actors use such tools can be important for understanding how campaigns are executed. Unlike malware, these tools or software packages are often found on a system and have legitimate purposes for power users, system administrators, network administrators, or even normal users. Remote access tools (e.g., RDP) and network scanning tools (e.g., Nmap) are examples of Tools that may be used by a Threat Actor during an attack."

    identity:
      # source: https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_wh296fiwpklp
      description: "Identities can represent actual individuals, organizations, or groups (e.g., ACME, Inc.) as well as classes of individuals, organizations, systems or groups (e.g., the finance sector)."

    location:
      # source: https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_th8nitr8jb4k
      description: "A Location represents a geographic location. The location may be described as any, some or all of the following: region (e.g., North America), civic address (e.g. New York, US), latitude and longitude."

    vulnerability:
      # source: https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_q5ytzmajn6re
      description: "A Vulnerability is a weakness or defect in the requirements, designs, or implementations of the computational logic (e.g., code) found in software and some hardware components (e.g., firmware) that can be directly exploited to negatively impact the confidentiality, integrity, or availability of that system."

    campaign:
      # source: https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_pcpvfz4ik6d6
      description: "A Campaign is a grouping of adversarial behaviors that describes a set of malicious activities or attacks (sometimes called waves) that occur over a period of time against a specific set of targets."

    threat-actor:
      # source: https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_k017w16zutw
      description: "Threat Actors are actual individuals, groups, or organizations believed to be operating with malicious intent. A Threat Actor is not an Intrusion Set but may support or be affiliated with various Intrusion Sets, groups, or organizations over time."

    domain-name:
      # source: https://en.wikipedia.org/wiki/Domain_name
      description: "In the Internet, a domain name is a string that identifies a realm of administrative autonomy, authority, or control. Domain names are often used to identify services provided through the Internet, such as websites, email services, and more."

    url:
      # source: https://en.wikipedia.org/wiki/URL
      description: "A uniform resource locator (URL), colloquially known as web address, is a reference to a resource on the World Wide Web. A URL specifies the location of a resource on a computer network and a mechanism for retrieving it. "

    indicator:
      # source: https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html#_muftrcpnf89v
      description: "Indicators contain a pattern that can be used to detect suspicious or malicious cyber activity. For example, an Indicator may be used to represent a set of malicious domains."

    file_paths:
      # source: https://en.wikipedia.org/wiki/Path_(computing)
      description: "A path (or filepath, file path, pathname, or similar) is a string that uniquely identifies an item in a hierarchical file system."

    sha256s:
      description: "Identify SHA-256 hashes"

    tactic:
      # source: https://attack.mitre.org/tactics/enterprise/
      description: "Tactics represent the 'why' of an ATT&CK technique or sub-technique. It is the adversary's tactical goal: the reason for performing an action. For example, an adversary may want to achieve credential access."


# Output settings
output:
  output_dir: null  # null = auto-generate based on dataset and model
  save_jsonl: true  # Save LangExtract JSONL format
  save_predictions: true  # Save BIO prediction format